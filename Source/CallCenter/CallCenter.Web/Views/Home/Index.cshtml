@{
    ViewBag.Title = "Bank of Griff";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<div class="row page-header">
    <h1>
        Bank of Griff - (202) 688-2265
    </h1>
</div>
<div class="row">
    <div class="span4">
        <h2>
            Number of Active Calls</h2>
        <h3 id="numberActiveCalls">
            0</h3>
        <h2>
            Number of Inactive Calls</h2>
        <h3 id="numberInactiveCalls">
            0</h3>
    </div>
    <div class="span4">
        <div id="areaCodeBarChart">
        </div>
    </div>
    <div class="span4">
        
    </div>
</div>
<div class="row">
    <div class="span6">
        <h2>Phone Calls</h2>
        <table id="tableCallList" width="100%">
            <thead>
                <tr>
                    <td>Number</td>
                    <td>Status</td>
                    <td>Duration</td>
                </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>
</div>
<script type="text/javascript" src="SignalR/Hubs"></script>
<script type="text/javascript">
    $(document).ready(function () {
        configureWijmo();

        var dashboard = $.connection.dashboardHub;

        dashboard.updateActiveCallCount = function (callList) {
            $("#numberActiveCalls").text(callList.length);
        };

        dashboard.updateInactiveCallCount = function (callList) {
            $("#numberInactiveCalls").text(callList.length);
        };

        dashboard.updateAreaCodeChart = function (areaCodeList) {
            $("#areaCodeBarChart").wijpiechart("option", "seriesList", areaCodeList);
        };

        dashboard.updateCallGrid = function (data) {
            $("#tableCallList").wijgrid("option", "data", data);
        };

        $.connection.hub.start().done(function () {
            dashboard.preload();
        });
    });

    function configureWijmo() {
        $("#areaCodeBarChart").wijpiechart({
            radius: 100,
            width: 300,
            height: 300,
            showChartLabels: false,
            header: {
                text: "Area Codes"
            },
            seriesList: [{ data: 1, label: "None", legendEntry: false}],
            seriesTransition: {
                easing: 'bounce',
                duration: 1000,
                enabled: false
            }
        });
        $("#tableCallList").wijgrid();
    }
</script>
